<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤ - ‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tailwindcss/forms/dist/forms.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
  <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
    <h1 class="text-2xl font-bold text-center mb-4">üìç ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤ - ‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô</h1>

    <input type="text" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" class="w-full mb-4 p-2 border rounded" />

    <select id="department" class="w-full mb-4 p-2 border rounded">
      <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option>
      <option>‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option>
      <option>NA IPD</option>
      <option>NA OPD</option>
      <option>NA ER</option>
      <option>X-RAY</option>
      <option>‡πÄ‡∏ß‡∏ä‡πÅ‡∏ú‡∏•</option>
      <option>‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå</option>
      <option>‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤</option>
      <option>‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</option>
      <option>‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</option>
      <option>LAB</option>
      <option>‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û</option>
      <option>‡∏≠‡∏±‡∏ü‡∏ü‡∏≠‡∏•</option>
      <option>‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</option>
      <option>‡πÅ‡∏°‡πà‡∏Ñ‡∏£‡∏±‡∏ß</option>
      <option>‡πÅ‡∏°‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£</option>
      <option>‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
      <option>‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ø</option>
      <option>‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£</option>
    </select>

    <button onclick="checkin()" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">
      ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤
    </button>

    <div id="status" class="mt-4 text-center text-sm"></div>
  </div>

  <script>
    async function checkin() {
      const name = document.getElementById("name").value.trim();
      const department = document.getElementById("department").value;
      const statusDiv = document.getElementById("status");

      statusDiv.innerHTML = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
      if (!name) {
        statusDiv.innerHTML = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠";
        return;
      }
      if (!department) {
        statusDiv.innerHTML = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏Å‡πà‡∏≠‡∏ô";
        return;
      }

      if (!navigator.geolocation) {
        statusDiv.innerHTML = "‚ùå ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GPS";
        return;
      }

      navigator.geolocation.getCurrentPosition(async (position) => {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;

        const formData = new URLSearchParams();
        formData.append("name", name);
        formData.append("department", department);
        formData.append("lat", lat);
        formData.append("lng", lng);

        try {
          const response = await fetch("https://script.google.com/macros/s/AKfycbxh3jbfXaVvSvuyglXcNHVbYXGencUpn8AzZVZPccjMU_Odppgbs1gp2x30d8ycvDwlmQ/exec", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: formData.toString(),
          });

          const result = await response.json();
          if (result.status === "success") {
            statusDiv.innerHTML = "‚úÖ " + result.message;
            statusDiv.classList.remove("text-red-500");
            statusDiv.classList.add("text-green-500");
          } else {
            statusDiv.innerHTML = "‚ùå " + result.message;
            statusDiv.classList.remove("text-green-500");
            statusDiv.classList.add("text-red-500");
          }
        } catch (error) {
          statusDiv.innerHTML = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error;
          statusDiv.classList.add("text-red-500");
        }
      }, () => {
        statusDiv.innerHTML = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á";
        statusDiv.classList.add("text-red-500");
      });
    }
  </script>
</body>
</html>
